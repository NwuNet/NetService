<extend name="base" />
<block name="title">
	<title>Network Service 管理</title>
</block>

<block name="quick-information">
	{:W('QuickInfo/message')}
	{:W('QuickInfo/notice')}
	{:W('QuickInfo/task')}
	{:W('QuickInfo/self')}
</block>

<block name="navigation">
	<div class="user-panel">
		<div class="pull-left image">
			<img src="__PUBLIC__{$user.img}" class="img-circle" alt="User Image">
		</div>
		<div class="pull-left info">
			<p>{$user.uname}</p>
			<a href="#"><i class="fa fa-circle text-success"></i> 在线</a>
		</div>
	</div>

	<!--search widget-->
	{:W('Search/index')}
	<!-- search widget -->

	<!--menu widget-->
	{:W('Menu/index',array('dopeople','dovacation'))}
	<!--menu widget-->
</block>

<block name="content-header">
	<h1>
		人事设置
		<small><span class="fa fa-fw fa-calendar-plus-o"></span>员工请假</small>
	</h1>
	<ol class="breadcrumb">
		<li><a href="#"><i class="fa fa-dashboard"></i> Network Service</a></li>
		<li class="active">首页</li>
	</ol>
</block>

<block name="content">
	<div class="row">
		<div class="col-md-6">
			<div class="box box-primary">
				<div class="box-header with-border">
					<i class="fa fa-fw fa-shopping-cart"></i>
					<h3 class="box-title">编辑请假条</h3>

					<div class="box-notes pull-right">
						<button type="button" class="btn btn-box-note" data-widget="collapse"><i class="fa fa-minus"></i>
						</button>
						<button type="button" class="btn btn-box-note" data-widget="remove"><i class="fa fa-times"></i></button>
					</div>
				</div>
				<div class="box-body">
					<form id="addform">
					  <div class="form-group">					  
						  <label>开始时间</label>
						  <div for="dtp_input1" class="input-group date form_date1 col-md-8" data-date="2016-01-16T05:25:07Z" data-date-format="yyyy-MM-dd HH:ii" data-link-field="dtp_input1" data-link-format="yyyy-mm-dd HH:ii">
                             <input id = "start_time" class="form-control" size="16" type="text" value="" readonly>
                             <span class="input-group-addon"><span class="glyphicon glyphicon-remove"></span></span>
					         <span class="input-group-addon"><span class="glyphicon glyphicon-calendar"></span></span>
                          </div>	
						  <label>结束时间</label>
						  <<div for="dtp_input2" class="input-group date form_date2 col-md-8" data-date="2016-01-16T05:25:07Z" data-date-format="yyyy-MM-dd HH:ii" data-link-field="dtp_input2" data-link-format="yyyy-mm-dd HH:ii">
                             <input id = "end_time" class="form-control" size="16" type="text" value="" readonly>
                             <span class="input-group-addon"><span class="glyphicon glyphicon-remove"></span></span>
					         <span class="input-group-addon"><span class="glyphicon glyphicon-calendar"></span></span>
                          </div>	
						  <label>理由</label>
						  <div class="from-group">						  
							<input type="text" class="form-control" id="reason" name="reason"   />
						  </div>						  						  
					</div>
					</form>
					<button type="submit" id="addbtn" class="btn btn-info btn-block">提交</button>
				</div>
				<!-- box-body -->
			</div>
			<!-- box -->
		</div>
		<!-- col -->
	</div>
	

</block>

<block name="script">
	
	<script type="text/javascript">	
	    /*
		 * 请假开始时间
		 * */
	    $('.form_date1').datetimepicker({
        language:  'zh-CN',
        weekStart: 1,
        todayBtn:  1,
		autoclose: 1,
		todayHighlight: 1,
		startView: 2,
		minView: 1,
		forceParse: 0,
		showMeridian: 0,		
		pickerPosition: "bottom-left"
        });	 
        /*
		 * 请假结束时间
		 * */
        $('.form_date2').datetimepicker({
        language:  'zh-CN',
        weekStart: 1,
        todayBtn:  1,
		autoclose: 1,
		todayHighlight: 1,
		startView: 2,
		minView: 1,
		forceParse: 0,
		showMeridian: 0,		
		pickerPosition: "bottom-left"
        });	  
		/*
		 * 添加用户
		 * */
		$("#addbtn").click(function() {
			var $btn = $(this).button('adding');
			$.post("<php>echo U('Boss/DoPeople/vacationadd')</php>", {
						uname: '{$user.uname}',
						start_time: $("#start_time").val(),
						end_time: $("#end_time").val(),
						reason: $("#addnumber")[0].value						
					},function(data) {
						$btn.button('reset');
						if (data == true) {
							alert("保存成功");
						} else {
							alert(data);
						}
						location.reload();
					});
		});
		/*
		 * datatables
		 * */
		var table = $("#example4").DataTable({
			"processing": true,
			"serverSide": true,
			"ajax": "<php>echo U('Boss/DoPeople/stafftable')</php>",
			"language": {
				"sProcessing":   "处理中...",
				"lengthMenu": "每页 _MENU_ 条记录",
				"zeroRecords": "没有找到记录",
				"info": "第 _PAGE_ 页 ( 总共 _PAGES_ 页 )",
				"infoEmpty": "无记录",
				"infoFiltered": "(从 _MAX_ 条记录过滤)",
				"search": "搜索",
				"sLoadingRecords": "载入中...",
				"paginate": {
					"previous": "前页",
					"next": "后页"
				}
			}
		});
//		$('#example4 tbody').on('click', 'tr', function() {
//			var id = $(this).children().first().html();
//			location.href = "index.php?s=/Boss-SetPeople-staffcard-id-" + id;
//		});
	</script>
</block>